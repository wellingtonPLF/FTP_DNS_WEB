.______________________________________________________________________________________. 
   # Important! #

 â­ Read Everything! And if this doesn't work, well your machine could be the problem.
.______________________________________________________________________________________. 

# De preferÃªncia use --> sudo su;

apt-get update && apt-get upgrade && apt update && clear

apt-get install apache2 && apt-get install apache2-utils && apt-get install bind9 && apt install vim && apt install libgnome2-bin && apt-get install dnsutils --fix-missing

.......................................................................
#Veja se tem algum processo utilizando a porta :80
netstat -tulpn | grep :80

#Se houver e nÃ£o for o apache, entÃ£o utilize o comando abaixo para achar o PID:
ss -6 -tlnp |grep 80

#Com o PID em mÃ£os, mate o processo: 
kill <pid_number>
.......................................................................

/etc/init.d/apache2 start

cd /var/www/

#Change the index.html by putting something like: <h1>Apache Works!</h1> #Use some text editor.
gnome-open html

#See if apache works by accessing url: [ localhost ]

#Creating a new location:
cd /etc/apache2/sites-available/
....................................................................................................................................................................
vi file.conf

#Dentro de file.conf coloque:
<VirtualHost *:80> 
	ServerName <nome-do-website>.<extensÃ£o> #ExtensÃ£o exemplo: [ .net | .com | .org ]
	DocumentRoot /var/www/<nome-da-pasta-que-irÃ¡-criar>  #Em seguida deverÃ¡ ser criado a pasta nomeada
</VirtualHost>

#Para sair e salvar o arquivo, use: [ Esc ] + [ : ] + [ wq! ] + [ Enter ]
....................................................................................................................................................................
cd /var/www/

mkdir <nome_da_pasta_atribuida>
cd <nome_da_pasta_atribuida>

#Coloque alguma coisa, tipo: <h1>DNS works!</h1>
vi index.html

cd /etc/apache2/sites-available/

a2ensite file.conf

service apache2 reload

a2ensite file.conf

# Use comando a seguir para saber o Ip e a Use Iface (ens33 or eth0):
> route
> ifconfig

vi /etc/bind/named.conf.local
..................................................................................
zone "<nome-do-website>.<extensÃ£o>" { 
	type master;
	file "/etc/bind/zonas/db.one"; 
};

zone "[ip-reverso-sem-o-ultimos-numeros-do-ip].in-addr.arpa" {       #Exemplo: 192.168.137.129 --> 137.168.192
	type master;
	file "/etc/bind/zonas/db.two"; 
};
.......................................................................................................

mkdir zonas

cp db.local zonas/db.one
cp db.127 zonas/db.two

cd zonas

#Comando para saber o nome da sua maquina: [ hostname ]

vi db.one
:..........................................................................................................................:

$TTL	604800
@	IN	SOA	<nome-da-maquina-virtual>.<nome-do-website>.<extensÃ£o>.	root.<nome-do-website>.<extensÃ£o>. (
				2						; Serial
			   604800						; Refresh
			    86400						; Retry
			  2419200						; Expire
			   604800 )						; Negative Cache TTL
;
@	IN	NS	<nome-da-maquina-virtual>.<nome-do-website>.<extensÃ£o>.
@	IN	A	<ip-da-maquina>
<nome-da-maquina-virtual>	IN	A	<ip-da-maquina>
<nome-do-website>	IN 	A	<ip-da-maquina>
roteador	IN	A	<ip-do-roteador>
www	IN	CNAME	<nome-do-website>.<extensÃ£o>.

:**************************************************************************************************************************:

vi db.two
:..........................................................................................................................:

$TTL	604800
@	IN	SOA	<nome-da-maquina-virtual>.<nome-do-website>.<extensÃ£o>.	root.<nome-do-website>.<extensÃ£o>. (
				1						; Serial
			   604800						; Refresh
			    86400						; Retry
			  2419200						; Expire
			   604800 )						; Negative Cache TTL
;
	IN	NS	<nome-da-maquina-virtual>.	#Tem que deixar a parte inicial em branco mesmo.
<Os ultimos digitos do IP da maquina>	IN	PTR	<nome-da-maquina-virtual>.<nome-do-website>.<extensÃ£o>.
<Os ultimos digitos do IP do roteador>	IN	PTR	roteador.<nome-do-website>.<extensÃ£o>.

:**************************************************************************************************************************:
#Test Zone
named-checkzone <nome-do-website>.<extensÃ£o> db.one
named-checkzone <nome-do-website>.<extensÃ£o> db.two

vi /etc/bind/named.conf.options

#Procure por forwarders dentro de options e coloque (Lembre-se de descomentar!):
forwarders{
	<IP-do-roteador>;
	8.8.8.8;
}

#Voltando ao terminal, colocar: 
/etc/init.d/bind9 start
/etc/init.d/bind9 restart 
/etc/init.d/bind9 reload

vi /etc/network/interfaces

auto lo
iface lo inet loopback

auto <Use Iface>			#Exemplo: ens33 or eth0
iface <Use Iface> inet static				
	address	<ip-da-maquina>
	netmask	255.255.255.0
	network	<network-da-rede>	#Exemplo: 192.168.137.0
	broadcast <broadcast-da-rede>	#Exemplo: 192.168.137.255
	gateway	<ip-do-roteador>
	dns-nameserver <ip-da-maquina>
	dns-search <nome-do-website>.<extensÃ£o>

vi /etc/hosts

#JÃ¡ na ediÃ§Ã£o coloque:								
<ip-da-maquina>	<nome-da-maquina>.<nome-do-website>.<extensÃ£o> <nome-da-maquina>

terminal, write: reboot

Pronto...

#Tente acessar o dns server (De preferÃªncia use: Mozilla FireFox), caso o mesmo nÃ£o apareÃ§a, tente:

ðŸ‘‰ Esperar alguns segundos e tentar novamente.
ðŸ‘‰ Usar: systemctl restart networking

#Se houver alguma perda de conexÃ£o com a internet, faÃ§a:

|.......................................|
  ðŸ‘‰ vi /etc/resolv.conf
  
  #Add another nameserver
  nameserver 8.8.8.8
|.......................................|
  ðŸ‘‰ systemctl restart networking
|.......................................|

That's it!

............................................................................
Para se conectar por fora, no SO windowns: entre na central de redes e compartilhamento que fica no painel de controle
,e vÃ¡ no DHCP , entÃ£o coloque o ip do servidor dns
............................................................................
